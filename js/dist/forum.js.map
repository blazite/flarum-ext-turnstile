{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://blazite-flarum-turnstile/webpack/bootstrap","webpack://blazite-flarum-turnstile/webpack/runtime/compat get default export","webpack://blazite-flarum-turnstile/webpack/runtime/define property getters","webpack://blazite-flarum-turnstile/webpack/runtime/hasOwnProperty shorthand","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/app']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/extend']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ForgotPasswordModal']\"","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/Component']\"","webpack://blazite-flarum-turnstile/./src/forum/components/Turnstile.tsx","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/components/Button']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ChangePasswordModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/SignUpModal']\"","webpack://blazite-flarum-turnstile/./src/forum/index.ts","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToSignUp.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToLogin.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToForgotPassword.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToChangePassword.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ForgotPasswordModal'];","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\nimport type { VnodeDOM, Vnode } from 'mithril';\n\ninterface ITurnstileAttrs {\n  action?: string;\n  onTurnstileStateChange?: (token: string | null) => void;\n  bindParent?: any;\n}\n\nexport default class Turnstile extends Component<ITurnstileAttrs> {\n  widgetId?: string;\n  element!: HTMLElement;\n  turnstileLoaded = false;\n\n  oninit(vnode: Vnode<ITurnstileAttrs, this>) {\n    super.oninit(vnode);\n    this.turnstileLoaded = typeof window.turnstile !== 'undefined';\n  }\n\n  get config() {\n    return {\n      sitekey: app.forum.attribute('blazite-turnstile.site_key'),\n      size: 'normal', // Use 'normal', 'compact', or 'invisible' if preferred\n      theme: this.getCurrentTheme(),\n      action: this.attrs.action ?? 'login',\n      callback: this.onTurnstileComplete.bind(this),\n      'expired-callback': this.onTurnstileExpire.bind(this),\n      'error-callback': this.onTurnstileError.bind(this),\n    };\n  }\n\n  getCurrentTheme() {\n    const getTheme = flarum.extensions['fof-nightmode']?.getTheme;\n    const Themes = flarum.extensions['fof-nightmode']?.Themes;\n    if (getTheme && Themes) {\n      let currentTheme = getTheme();\n      if (currentTheme === Themes.AUTO) {\n        currentTheme = window.matchMedia('(prefers-color-scheme:dark)').matches ? Themes.DARK : Themes.LIGHT;\n      }\n      return currentTheme === Themes.DARK ? 'dark' : 'light';\n    }\n\n    return !!!app.forum.attribute('turnstile_dark_mode') ? 'light' : 'dark';\n  }\n\n  onTurnstileComplete(token: string) {\n    this.attrs.onTurnstileStateChange?.(token);\n  }\n\n  onTurnstileExpire() {\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  onTurnstileError() {\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  createTurnstile() {\n    if (!this.turnstileLoaded) return;\n\n    // remove any existing widget if already on node\n    this.removeTurnstile();\n\n    this.widgetId = window.turnstile.render(this.element, this.config);\n\n    if (this.attrs.bindParent) {\n      this.attrs.bindParent.turnstile = {\n        reset: () => {\n          if (this.widgetId) {\n            window.turnstile.reset(this.widgetId);\n            this.attrs.onTurnstileStateChange?.(null);\n          }\n        },\n      };\n    }\n  }\n\n  removeTurnstile() {\n    if (this.widgetId && window.turnstile) {\n      window.turnstile.remove(this.widgetId);\n      this.widgetId = undefined;\n    }\n  }\n\n  oncreate(vnode: VnodeDOM<ITurnstileAttrs, this>): void {\n    super.oncreate(vnode);\n    this.element = vnode.dom as HTMLElement;\n    this.createTurnstile();\n  }\n\n  onupdate() {\n    // Optional: re-render if needed due to change\n  }\n\n  onbeforeremove() {\n    this.removeTurnstile();\n  }\n\n  view() {\n    if (!this.turnstileLoaded) {\n      return (\n        <p class=\"BlaziteTurnstile-notLoaded\">\n          {app.translator.trans('blazite-turnstile.forum.not_loaded_error')}\n        </p>\n      );\n    }\n\n    return <div class=\"Blazite-Turnstile Form-group\" />;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangePasswordModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SignUpModal'];","import app from 'flarum/forum/app';\nimport addTurnstileToForgotPassword from './extend/addTurnstileToForgotPassword';\nimport addTurnstileToChangePassword from './extend/addTurnstileToChangePassword';\nimport addTurnstileToLogin from './extend/addTurnstileToLogin';\nimport addTurnstileToSignUp from './extend/addTurnstileToSignUp';\n\napp.initializers.add('blazite/flarum-turnstile', () => {\n  addTurnstileToSignUp();\n  addTurnstileToLogin();\n  addTurnstileToForgotPassword();\n  addTurnstileToChangePassword();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToSignUp() {\n  extend(SignUpModal.prototype, 'submitData', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(SignUpModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    this.turnstile = null;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"sign_up\"\n        bindParent={this}\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(SignUpModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    if (this.turnstile?.reset) {\n      this.turnstile.reset();\n    }\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content =\n        app.translator.trans('blazite-turnstile.forum.validation_error') ||\n        'Please complete the Turnstile challenge.';\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToLogin() {\n  extend(LogInModal.prototype, 'loginParams', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(LogInModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n\n    this.turnstile = null;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"log_in\"\n        bindParent={this}\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(LogInModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n\n    if (this.turnstile?.reset) {\n      this.turnstile.reset();\n    }\n\n    this.__turnstileToken = null;\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content = app.translator.trans('blazite-turnstile.forum.validation_error');\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport ForgotPasswordModal from 'flarum/forum/components/ForgotPasswordModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToForgotPassword() {\n  extend(ForgotPasswordModal.prototype, 'requestParams', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(ForgotPasswordModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    this.turnstile = null;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"forgot_pw\"\n        bindParent={this}\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(ForgotPasswordModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    if (this.turnstile?.reset) {\n      this.turnstile.reset();\n    }\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content =\n        app.translator.trans('blazite-turnstile.forum.validation_error') ||\n        'Please complete the CAPTCHA challenge.';\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}\n","import app from 'flarum/forum/app';\nimport { override, extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport ChangePasswordModal from 'flarum/forum/components/ChangePasswordModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToChangePassword() {\n  ChangePasswordModal.prototype.__turnstileToken = null;\n\n  extend(ChangePasswordModal.prototype, 'oninit', function (this: ChangePasswordModal) {\n    this.loading = true;\n  });\n\n  override(ChangePasswordModal.prototype, 'content', function (this: ChangePasswordModal, original) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return original();\n\n    this.turnstile = null;\n\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form Form--centered\">\n          <p className=\"helpText\">{app.translator.trans('core.forum.change_password.text')}</p>\n          <div className=\"Form-group\">\n            {Button.component(\n              {\n                className: 'Button Button--primary Button--block',\n                type: 'submit',\n                loading: this.loading,\n                disabled: this.loading,\n              },\n              app.translator.trans('core.forum.change_password.send_button')\n            )}\n          </div>\n          <Turnstile\n            action=\"forgot_pw\"\n            bindParent={this}\n            onTurnstileStateChange={(token) => {\n              this.__turnstileToken = token;\n              this.loading = false;\n              m.redraw();\n            }}\n          />\n        </div>\n      </div>\n    );\n  });\n\n  override(ChangePasswordModal.prototype, 'onsubmit', function (this: ChangePasswordModal, original, e: SubmitEvent) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return original.call(this, e);\n\n    e.preventDefault();\n    this.loading = true;\n\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/forgot',\n      body: {\n        email: app.session.user!.email(),\n        turnstileToken: this.__turnstileToken,\n      },\n    }).then(this.hide.bind(this)).catch((error) => {\n      if (this.turnstile?.reset) {\n        this.turnstile.reset();\n      }\n\n      if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n        error.alert.content =\n          app.translator.trans('blazite-turnstile.forum.validation_error') ||\n          'Please complete the Turnstile challenge.';\n      }\n\n      this.alertAttrs = error.alert;\n      this.loading = false;\n      m.redraw();\n      this.onready();\n    });\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_typeof","Symbol","iterator","constructor","toPropertyKey","t","i","e","toPrimitive","r","TypeError","String","_defineProperties","length","configurable","writable","_setPrototypeOf","setPrototypeOf","bind","__proto__","Turnstile","_Component","_this","_len","arguments","args","Array","_key","apply","concat","widgetId","element","turnstileLoaded","create","_proto","oninit","vnode","this","window","turnstile","getCurrentTheme","_flarum$extensions$fo","_flarum$extensions$fo2","getTheme","extensions","Themes","currentTheme","AUTO","matchMedia","matches","DARK","LIGHT","app","attribute","onTurnstileComplete","token","_this$attrs$onTurnsti","_this$attrs","attrs","onTurnstileStateChange","onTurnstileExpire","_this$attrs$onTurnsti2","_this$attrs2","onTurnstileError","_this$attrs$onTurnsti3","_this$attrs3","createTurnstile","_this2","removeTurnstile","render","config","bindParent","reset","remove","undefined","oncreate","dom","onupdate","onbeforeremove","view","m","class","trans","_this$attrs$action","sitekey","size","theme","action","callback","Component","add","extend","SignUpModal","data","turnstileToken","__turnstileToken","fields","_","error","_this$turnstile","alert","content","alertAttrs","redraw","onready","LogInModal","ForgotPasswordModal","ChangePasswordModal","loading","override","original","className","Button","type","disabled","preventDefault","method","url","body","email","user","then","hide","_this2$turnstile"],"sourceRoot":""}