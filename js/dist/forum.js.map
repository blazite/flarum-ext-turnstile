{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://blazite-flarum-turnstile/webpack/bootstrap","webpack://blazite-flarum-turnstile/webpack/runtime/compat get default export","webpack://blazite-flarum-turnstile/webpack/runtime/define property getters","webpack://blazite-flarum-turnstile/webpack/runtime/hasOwnProperty shorthand","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/app']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/extend']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ForgotPasswordModal']\"","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/Component']\"","webpack://blazite-flarum-turnstile/./src/forum/components/Turnstile.tsx","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/components/Button']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ChangePasswordModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/SignUpModal']\"","webpack://blazite-flarum-turnstile/./src/forum/index.ts","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToSignUp.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToLogin.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToForgotPassword.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToChangePassword.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ForgotPasswordModal'];","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\n\nimport type { VnodeDOM, Vnode } from 'mithril';\n\ninterface ITurnstileAttrs {\n  action?: string;\n  onTurnstileStateChange?: (token: string | null) => void;\n}\n\nexport default class Turnstile extends Component<ITurnstileAttrs> {\n  widgetId?: string;\n  turnstileLoaded!: boolean;\n\n  oninit(vnode: Vnode<ITurnstileAttrs, this>) {\n    super.oninit(vnode);\n\n    this.turnstileLoaded = !!window.turnstile;\n  }\n\n  get config() {\n    const { action } = this.attrs;\n\n    return {\n      action,\n      theme: this.getCurrentTheme(),\n      language: app.translator.getLocale() || 'auto',\n      sitekey: app.forum.attribute('blazite-turnstile.site_key'),\n      size: 'flexible',\n      callback: this.onTurnstileComplete.bind(this),\n      'expired-callback': this.onTurnstileExpire.bind(this),\n      'error-callback': this.onTurnstileError.bind(this),\n    };\n  }\n\n  getCurrentTheme() {\n    const getTheme = flarum.extensions['fof-nightmode']?.getTheme;\n    const Themes = flarum.extensions['fof-nightmode']?.Themes;\n\n    if (getTheme && Themes) {\n      let currentTheme = getTheme();\n\n      if (currentTheme === Themes.AUTO) {\n        currentTheme = window.matchMedia('(prefers-color-scheme:dark)').matches ? Themes.DARK : Themes.LIGHT;\n      }\n\n      if (currentTheme === Themes.DARK) {\n        return 'dark';\n      } else if (currentTheme === Themes.LIGHT) {\n        return 'light';\n      }\n    }\n\n    // fof/nightmode is not installed, so we fall back to detecting if the forum has been set to dark mode or not.\n    return !!!app.forum.attribute('turnstile_dark_mode') ? 'light' : 'dark';\n  }\n\n  onTurnstileComplete(token: string) {\n    this.attrs.onTurnstileStateChange?.(token);\n  }\n\n  onTurnstileExpire() {\n    if (this.widgetId) window.turnstile.reset(this.widgetId);\n\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  onTurnstileError() {\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  createTurnstile() {\n    if (!this.turnstileLoaded) return;\n\n    window.turnstile.render(this.element, this.config);\n  }\n\n  removeTurnstile() {\n    if (!this.turnstileLoaded) return;\n\n    if (this.widgetId) window.turnstile.remove(this.widgetId);\n  }\n\n  oncreate(vnode: VnodeDOM<ITurnstileAttrs, this>): void {\n    super.oncreate(vnode);\n\n    this.createTurnstile();\n  }\n\n  onbeforeremove(vnode: VnodeDOM<ITurnstileAttrs, this>): void {\n    super.onbeforeremove(vnode);\n\n    this.removeTurnstile();\n  }\n\n  view(vnode: VnodeDOM<ITurnstileAttrs, this>) {\n    if (!this.turnstileLoaded) {\n      return <p class=\"BlaziteTurnstile-notLoaded\">{app.translator.trans('blazite-turnstile.forum.not_loaded_error')}</p>;\n    }\n\n    return <div class=\"Blazite-Turnstile Form-group\" />;\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangePasswordModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SignUpModal'];","import app from 'flarum/forum/app';\nimport addTurnstileToForgotPassword from './extend/addTurnstileToForgotPassword';\nimport addTurnstileToChangePassword from './extend/addTurnstileToChangePassword';\nimport addTurnstileToLogin from './extend/addTurnstileToLogin';\nimport addTurnstileToSignUp from './extend/addTurnstileToSignUp';\n\napp.initializers.add('blazite/flarum-turnstile', () => {\n  addTurnstileToSignUp();\n  addTurnstileToLogin();\n  addTurnstileToForgotPassword();\n  addTurnstileToChangePassword();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\n\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToSignUp() {\n  extend(SignUpModal.prototype, 'submitData', function (data) {\n    if (!!!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(SignUpModal.prototype, 'fields', function (fields) {\n    if (!!!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"sign_up\"\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToLogin() {\n  extend(LogInModal.prototype, 'loginParams', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(LogInModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"log_in\"\n        onTurnstileStateChange={(token: string | null) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  override(LogInModal.prototype, 'onerror', function (original, error) {\n    if (error?.status === 422 && Array.isArray(error.response?.errors)) {\n      const errors = error.response.errors;\n\n\n      const turnstileError = errors.find((e) =>\n        e.source?.pointer?.includes('turnstileToken')\n      );\n\n      const message = app.translator.trans('validation.turnstile');\n\n      if (turnstileError) {\n        this.alertAttrs = {\n          type: 'error',\n          content: message || 'CAPTCHA failed or incomplete',\n        };\n        m.redraw();\n        this.onready();\n        return;\n      }\n    }\n\n    original(error);\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport ForgotPasswordModal from 'flarum/forum/components/ForgotPasswordModal';\n\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToForgotPassword() {\n  extend(ForgotPasswordModal.prototype, 'requestParams', function (data) {\n    if (!!!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(ForgotPasswordModal.prototype, 'fields', function (fields) {\n    if (!!!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"forgot_pw\"\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n}\n","import app from 'flarum/forum/app';\nimport { override, extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport ChangePasswordModal from 'flarum/forum/components/ChangePasswordModal';\n\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToForgotPassword() {\n  ChangePasswordModal.prototype.__turnstileToken = null;\n\n  extend(ChangePasswordModal.prototype, 'oninit', function (this: ChangePasswordModal) {\n    this.loading = true;\n  });\n\n  override(ChangePasswordModal.prototype, 'content', function (this: ChangePasswordModal, original) {\n    if (!!!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form Form--centered\">\n          <p className=\"helpText\">{app.translator.trans('core.forum.change_password.text')}</p>\n          <div className=\"Form-group\">\n            {Button.component(\n              {\n                className: 'Button Button--primary Button--block',\n                type: 'submit',\n                loading: this.loading,\n                disabled: this.loading,\n              },\n              app.translator.trans('core.forum.change_password.send_button')\n            )}\n          </div>\n          <Turnstile\n            action=\"forgot_pw\"\n            onTurnstileStateChange={(token) => {\n              this.__turnstileToken = token;\n              this.loading = false;\n              m.redraw();\n            }}\n          />\n        </div>\n      </div>\n    );\n  });\n\n  override(ChangePasswordModal.prototype, 'onsubmit', function (this: ChangePasswordModal, original, e: SubmitEvent) {\n    if (!!!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    e.preventDefault();\n\n    this.loading = true;\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/forgot',\n        body: {\n          email: app.session.user!.email(),\n          turnstileToken: this.__turnstileToken,\n        },\n      })\n      .then(this.hide.bind(this), this.loaded.bind(this));\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_typeof","Symbol","iterator","constructor","toPropertyKey","t","i","e","toPrimitive","r","TypeError","String","_defineProperties","length","configurable","writable","_setPrototypeOf","setPrototypeOf","bind","__proto__","Turnstile","_Component","_this","_len","arguments","args","Array","_key","apply","concat","widgetId","turnstileLoaded","create","_proto","oninit","vnode","this","window","turnstile","getCurrentTheme","_flarum$extensions$fo","_flarum$extensions$fo2","getTheme","extensions","Themes","currentTheme","AUTO","matchMedia","matches","DARK","LIGHT","app","attribute","onTurnstileComplete","token","_this$attrs$onTurnsti","_this$attrs","attrs","onTurnstileStateChange","onTurnstileExpire","_this$attrs$onTurnsti2","_this$attrs2","reset","onTurnstileError","_this$attrs$onTurnsti3","_this$attrs3","createTurnstile","render","element","config","removeTurnstile","remove","oncreate","onbeforeremove","view","m","class","trans","action","theme","language","getLocale","sitekey","size","callback","Component","add","extend","SignUpModal","data","turnstileToken","__turnstileToken","fields","LogInModal","override","original","error","_error$response","status","isArray","response","errors","turnstileError","find","_e$source","source","pointer","includes","message","alertAttrs","type","content","redraw","onready","ForgotPasswordModal","ChangePasswordModal","loading","className","Button","disabled","preventDefault","method","url","body","email","user","then","hide","loaded"],"sourceRoot":""}