{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://blazite-flarum-turnstile/webpack/bootstrap","webpack://blazite-flarum-turnstile/webpack/runtime/compat get default export","webpack://blazite-flarum-turnstile/webpack/runtime/define property getters","webpack://blazite-flarum-turnstile/webpack/runtime/hasOwnProperty shorthand","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/app']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/extend']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ForgotPasswordModal']\"","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/Component']\"","webpack://blazite-flarum-turnstile/./src/forum/components/Turnstile.tsx","webpack://blazite-flarum-turnstile/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['common/components/Button']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/ChangePasswordModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://blazite-flarum-turnstile/external root \"flarum.core.compat['forum/components/SignUpModal']\"","webpack://blazite-flarum-turnstile/./src/forum/index.ts","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToSignUp.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToLogin.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToForgotPassword.tsx","webpack://blazite-flarum-turnstile/./src/forum/extend/addTurnstileToChangePassword.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ForgotPasswordModal'];","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\nimport type { VnodeDOM, Vnode } from 'mithril';\n\ninterface ITurnstileAttrs {\n  action?: string;\n  onTurnstileStateChange?: (token: string | null) => void;\n}\n\nexport default class Turnstile extends Component<ITurnstileAttrs> {\n  widgetId?: string;\n  turnstileLoaded!: boolean;\n\n  oninit(vnode: Vnode<ITurnstileAttrs, this>) {\n    super.oninit(vnode);\n    this.turnstileLoaded = !!window.turnstile;\n  }\n\n  get config() {\n    const { action } = this.attrs;\n    return {\n      action,\n      theme: this.getCurrentTheme(),\n      language: app.translator.getLocale() || 'auto',\n      sitekey: app.forum.attribute('blazite-turnstile.site_key'),\n      size: 'flexible',\n      callback: this.onTurnstileComplete.bind(this),\n      'expired-callback': this.onTurnstileExpire.bind(this),\n      'error-callback': this.onTurnstileError.bind(this),\n    };\n  }\n\n  getCurrentTheme() {\n    const getTheme = flarum.extensions['fof-nightmode']?.getTheme;\n    const Themes = flarum.extensions['fof-nightmode']?.Themes;\n\n    if (getTheme && Themes) {\n      let currentTheme = getTheme();\n\n      if (currentTheme === Themes.AUTO) {\n        currentTheme = window.matchMedia('(prefers-color-scheme:dark)').matches\n          ? Themes.DARK\n          : Themes.LIGHT;\n      }\n\n      return currentTheme === Themes.DARK ? 'dark' : 'light';\n    }\n\n    return !!!app.forum.attribute('turnstile_dark_mode') ? 'light' : 'dark';\n  }\n\n  onTurnstileComplete(token: string) {\n    this.attrs.onTurnstileStateChange?.(token);\n  }\n\n  onTurnstileExpire() {\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  onTurnstileError() {\n    this.attrs.onTurnstileStateChange?.(null);\n  }\n\n  createTurnstile() {\n    if (!this.turnstileLoaded) return;\n\n    // Render Turnstile and grab widgetId\n    this.widgetId = window.turnstile.render(this.element, this.config);\n  }\n\n  removeTurnstile() {\n    if (!this.turnstileLoaded) return;\n\n    if (this.widgetId) {\n      window.turnstile.remove(this.widgetId);\n    }\n  }\n\n  oncreate(vnode: VnodeDOM<ITurnstileAttrs, this>) {\n    super.oncreate(vnode);\n    this.createTurnstile();\n  }\n\n  onbeforeremove(vnode: VnodeDOM<ITurnstileAttrs, this>) {\n    super.onbeforeremove(vnode);\n    this.removeTurnstile();\n  }\n\n  view() {\n    if (!this.turnstileLoaded) {\n      return (\n        <p class=\"BlaziteTurnstile-notLoaded\">\n          {app.translator.trans('blazite-turnstile.forum.not_loaded_error')}\n        </p>\n      );\n    }\n\n    return <div class=\"Blazite-Turnstile Form-group\" />;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangePasswordModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SignUpModal'];","import app from 'flarum/forum/app';\nimport addTurnstileToForgotPassword from './extend/addTurnstileToForgotPassword';\nimport addTurnstileToChangePassword from './extend/addTurnstileToChangePassword';\nimport addTurnstileToLogin from './extend/addTurnstileToLogin';\nimport addTurnstileToSignUp from './extend/addTurnstileToSignUp';\n\napp.initializers.add('blazite/flarum-turnstile', () => {\n  addTurnstileToSignUp();\n  addTurnstileToLogin();\n  addTurnstileToForgotPassword();\n  addTurnstileToChangePassword();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToSignUp() {\n  extend(SignUpModal.prototype, 'submitData', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(SignUpModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    this.turnstile = null;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"sign_up\"\n        bindParent={this}\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(SignUpModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.signup')) return;\n\n    if (this.turnstile?.reset) {\n      this.turnstile.reset();\n    }\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content =\n        app.translator.trans('blazite-turnstile.forum.validation_error') ||\n        'Please complete the Turnstile challenge.';\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToLogin() {\n  extend(LogInModal.prototype, 'oninit', function () {\n    this.turnstileVersion = 0;\n  });\n\n  extend(LogInModal.prototype, 'loginParams', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(LogInModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        key={`turnstile-${this.turnstileVersion}`} // ✅ ensure rerender!\n        action=\"log_in\"\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(LogInModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.signin')) return;\n\n    // ✅ Rerender the Turnstile widget by changing the key\n    this.turnstileVersion++;\n    this.__turnstileToken = null;\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content =\n        app.translator.trans('blazite-turnstile.forum.validation_error') ||\n        'Please complete the CAPTCHA.';\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport ForgotPasswordModal from 'flarum/forum/components/ForgotPasswordModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToForgotPassword() {\n  extend(ForgotPasswordModal.prototype, 'requestParams', function (data) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n    data.turnstileToken = this.__turnstileToken;\n  });\n\n  extend(ForgotPasswordModal.prototype, 'fields', function (fields) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    this.turnstile = null;\n\n    fields.add(\n      'turnstile',\n      <Turnstile\n        action=\"forgot_pw\"\n        bindParent={this}\n        onTurnstileStateChange={(token) => {\n          this.__turnstileToken = token;\n        }}\n      />,\n      -5\n    );\n  });\n\n  extend(ForgotPasswordModal.prototype, 'onerror', function (_, error) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return;\n\n    if (this.turnstile?.reset) {\n      this.turnstile.reset();\n    }\n\n    if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n      error.alert.content =\n        app.translator.trans('blazite-turnstile.forum.validation_error') ||\n        'Please complete the CAPTCHA challenge.';\n    }\n\n    this.alertAttrs = error.alert;\n    m.redraw();\n    this.onready();\n  });\n}\n","import app from 'flarum/forum/app';\nimport { override, extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport ChangePasswordModal from 'flarum/forum/components/ChangePasswordModal';\nimport Turnstile from '../components/Turnstile';\n\nexport default function addTurnstileToChangePassword() {\n  ChangePasswordModal.prototype.__turnstileToken = null;\n\n  extend(ChangePasswordModal.prototype, 'oninit', function (this: ChangePasswordModal) {\n    this.loading = true;\n  });\n\n  override(ChangePasswordModal.prototype, 'content', function (this: ChangePasswordModal, original) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return original();\n\n    this.turnstile = null;\n\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form Form--centered\">\n          <p className=\"helpText\">{app.translator.trans('core.forum.change_password.text')}</p>\n          <div className=\"Form-group\">\n            {Button.component(\n              {\n                className: 'Button Button--primary Button--block',\n                type: 'submit',\n                loading: this.loading,\n                disabled: this.loading,\n              },\n              app.translator.trans('core.forum.change_password.send_button')\n            )}\n          </div>\n          <Turnstile\n            action=\"forgot_pw\"\n            bindParent={this}\n            onTurnstileStateChange={(token) => {\n              this.__turnstileToken = token;\n              this.loading = false;\n              m.redraw();\n            }}\n          />\n        </div>\n      </div>\n    );\n  });\n\n  override(ChangePasswordModal.prototype, 'onsubmit', function (this: ChangePasswordModal, original, e: SubmitEvent) {\n    if (!app.forum.attribute('blazite-turnstile.forgot')) return original.call(this, e);\n\n    e.preventDefault();\n    this.loading = true;\n\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/forgot',\n      body: {\n        email: app.session.user!.email(),\n        turnstileToken: this.__turnstileToken,\n      },\n    }).then(this.hide.bind(this)).catch((error) => {\n      if (this.turnstile?.reset) {\n        this.turnstile.reset();\n      }\n\n      if (error.alert && (!error.alert.content || !error.alert.content.length)) {\n        error.alert.content =\n          app.translator.trans('blazite-turnstile.forum.validation_error') ||\n          'Please complete the Turnstile challenge.';\n      }\n\n      this.alertAttrs = error.alert;\n      this.loading = false;\n      m.redraw();\n      this.onready();\n    });\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_typeof","Symbol","iterator","constructor","toPropertyKey","t","i","e","toPrimitive","r","TypeError","String","_defineProperties","length","configurable","writable","_setPrototypeOf","setPrototypeOf","bind","__proto__","Turnstile","_Component","_this","_len","arguments","args","Array","_key","apply","concat","widgetId","turnstileLoaded","create","_proto","oninit","vnode","this","window","turnstile","getCurrentTheme","_flarum$extensions$fo","_flarum$extensions$fo2","getTheme","extensions","Themes","currentTheme","AUTO","matchMedia","matches","DARK","LIGHT","app","attribute","onTurnstileComplete","token","_this$attrs$onTurnsti","_this$attrs","attrs","onTurnstileStateChange","onTurnstileExpire","_this$attrs$onTurnsti2","_this$attrs2","onTurnstileError","_this$attrs$onTurnsti3","_this$attrs3","createTurnstile","render","element","config","removeTurnstile","remove","oncreate","onbeforeremove","view","m","class","trans","action","theme","language","getLocale","sitekey","size","callback","Component","add","extend","SignUpModal","data","turnstileToken","__turnstileToken","fields","bindParent","_","error","_this$turnstile","reset","alert","content","alertAttrs","redraw","onready","LogInModal","turnstileVersion","ForgotPasswordModal","ChangePasswordModal","loading","override","original","className","Button","type","disabled","_this2","preventDefault","method","url","body","email","user","then","hide","_this2$turnstile"],"sourceRoot":""}